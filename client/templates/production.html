<div ng-if="productionCtrl.ready">
  <div class="production-view col-sm-3">
    <div class="section">
      <div class="col-sm-12 title">
        <h3 class="no-margin">
          PRODUCTION
        </h3>
        <p class="bottom-border">{{ productionCtrl.production.date | date:'shortDate'}}</p>
        <form ng-submit="productionCtrl.editProduction()">
          <div class="production-name form-group">
            <label for="productionName">Title</label>
            <input ng-show="productionCtrl.editingState" ng-model="productionCtrl.production.name" class="form-control" id="productionName">
            <p class="disabled-form-control" ng-hide="productionCtrl.editingState"> {{productionCtrl.production.name}} </p>
          </div>
          <div class="production-name form-group">
            <label for="productionProducer">Producer</label>
            <p class="disabled-form-control"> {{productionCtrl.production.by_.first_name + ' ' + productionCtrl.production.by_.last_name}} </p>
          </div>
          <div class="form-group">
            <label for="production1Location">Location</label>
            <input ng-show="productionCtrl.editingState" ng-model="productionCtrl.production.location[0]" class="form-control" id="production1Location">
            <p class="disabled-form-control"  ng-hide="productionCtrl.editingState"> {{productionCtrl.production.location[0]}} </p>
          </div>
          <div class="form-group">
            <label for="production2Location">Location #2</label>
            <input ng-show="productionCtrl.editingState" ng-model="productionCtrl.production.location[1]" class="form-control" id="production2Location">
            <p class="disabled-form-control"  ng-hide="productionCtrl.editingState"> {{productionCtrl.production.location[1]}} </p>
          </div>
          <div class="form-group">
            <label for="productionCrewCall">General Crew Call</label>
            <input ng-show="productionCtrl.editingState" ng-model="productionCtrl.production.crewCall" class="form-control" id="productionCrewCall" type="time">
            <p class="disabled-form-control"  ng-hide="productionCtrl.editingState"> {{productionCtrl.production.crewCall | date : "shortTime"}} </p>
          </div>
          <div class="form-group">
            <label for="productionWeather">Weather</label>
            <input ng-show="productionCtrl.editingState" ng-model="productionCtrl.production.weather" class="form-control" id="productionWeather">
            <p class="disabled-form-control"  ng-hide="productionCtrl.editingState"> {{productionCtrl.production.weather}} </p>
          </div>
          <div class="form-group">
            <label for="productionHospital">Hospital</label>
            <input ng-show="productionCtrl.editingState" ng-model="productionCtrl.production.hospital" class="form-control" id="productionHospital">
            <p class="disabled-form-control"  ng-hide="productionCtrl.editingState"> {{productionCtrl.production.hospital}} </p>
          </div>
          <div class="form-group">
            <label for="productionParking">Parking</label>
            <input ng-show="productionCtrl.editingState" ng-model="productionCtrl.production.parking" class="form-control" id="productionParking"></input>
            <p class="disabled-form-control"  ng-hide="productionCtrl.editingState"> {{productionCtrl.production.parking}} </p>
          </div>
          <div class="form-group">
            <label for="productionNotes">Notes:</label>
            <textarea ng-show="productionCtrl.editingState" ng-model="productionCtrl.production.notes" class="form-control" id="productionNotes"></textarea>
            <p class="disabled-form-control"  ng-hide="productionCtrl.editingState"> {{productionCtrl.production.notes}} </p>
          </div>
          <!-- TODO Works for Entering Info, not Displaying -->
          <!-- <div class="form-group">
            <label for="productionStart">Start:</label>
            <input ng-model="productionCtrl.production.dateFrom" class="form-control" id="productionStart" type="date"></input>
          </div>
          <div class="form-group">
            <label for="productionEnd">End:</label>
            <input ng-model="productionCtrl.production.dateTo" class="form-control" id="productionEnd" type="date"></input>
          </div> -->
          <div ng-if="productionCtrl.isProducer && productionCtrl.compareDate(productionCtrl.production.date)">
            <!-- <a ng-click="productionCtrl.deleteProduction()" class="btn btn-danger">Complete</a> -->
            <button ng-show="productionCtrl.editingState" type="submit" class="btn default-btn">Update</button>
            <a ng-hide="productionCtrl.editingState" ng-click="productionCtrl.editingState = !productionCtrl.editingState" class="btn default-btn">Edit</a>
            <a ng-click="productionCtrl.notifyCrew()" class="btn approval-btn">Notify Crew</a>
          </div>
        </form>
      </div>
    </div>
  </div>

  <div class="crew-view col-sm-9" ng-init="showModal=false">
    <div class="section">
      <div class="crew-list">
        <div class="col-sm-6 no-padding">
          <h3 class="title">CAST AND CREW</h3>
        </div>
        <div class="col-sm-6 no-padding">
          <div ng-if="productionCtrl.isProducer && productionCtrl.compareDate(productionCtrl.production.date)" class="text-right title">
            <a class="btn default-btn" ng-click="productionCtrl.openModal()">+ Add Crew</a>
          </div>
        </div>
        <div class="crew-list col-sm-12 no-padding">
          <div ng-repeat="crew in productionCtrl.production.crew track by crew._id" class="line-item" ng-if="crew.active && ((productionCtrl.isProducer &&  productionCtrl.compareDate(productionCtrl.production.date)) || crew.offer.position)">
            <div class="col-xs-1 text-left">
              <img class="thumb round" ng-show="!crew.to.picture" ng-src="./img/profile_default.png">
              <img class="thumb round" ng-show="crew.to.picture" ng-src={{crew.to.picture}}>
            </div>
            <div class="col-xs-2">
              <p class="no-margin">{{crew.to.first_name + ' ' + crew.to.last_name || 'Crew Name'}}</p>
            </div>
            <div class="{{ productionCtrl.isProducer ? 'col-xs-2' : 'col-xs-4' }} dropdown">
              <!-- No way to style these really, yikes unless we use ui-bootstrap(nooooo) -->
              <select ng-hide="crew.offer.position" class="form-control bg-transparent subtle-border-2" ng-model="productionCtrl.offers[$index].position">
                <option value="Actor">Actor</option>
                <option value="Actress">Actress</option>
                <option value="Extra">Extra</option>
                <option value="Extra">Editor</option>
                <option value="Extra">Junior Editor</option>
                <option value="Extra">Animator</option>
                <option value="Extra">Motion Graphics Artist</option>
                <option value="Extra">Compositor</option>
                <option value="Executive Producer">Executive Producer</option>
                <option value="Line Producer">Line Producer</option>
                <option value="Producer">Producer</option>
                <option value="Unit Production Manager">Unit Production Manager</option>
                <option value="Director">Director</option>
                <option value="2nd Unit Director">2nd Unit Director</option>
                <option value="Producer / Director">Producer / Director</option>
                <option value="Writer / Director">Writer / Director</option>
                <option value="1st Assistant Director">1st Assistant Director</option>
                <option value="2nd Assistant Director">2nd Assistant Director</option>
                <option value="2nd 2nd Assistant Director">2nd 2nd Assistant Director</option>
                <option value="Writer">Writer</option>
                <option value="Teleprompter Operator">Teleprompter Operator</option>
                <option value="Cinematographer">Cinematographer</option>
                <option value="Camera Operator">Camera Operator</option>
                <option value="Steadicam Operator">Steadicam Operator</option>
                <option value="Jib / Crane Operator">Jib / Crane Operator</option>
                <option value="Ronin / Movi Operator">Ronin / Movi Operator</option>
                <option value="Drone Operator">Drone Operator</option>
                <option value="Drone Assistant">Drone Assistant</option>
                <option value="1st Assistant Camera Operator">1st Assistant Camera Operator</option>
                <option value="2nd Assistant Camera Operator">2nd Assistant Camera Operator</option>
                <option value="A Camera Operator">"A" Camera Operator</option>
                <option value="A 1st Assistant Camera Operator">"A" 1st Assistant Camera Operator</option>
                <option value="A 2nd Assistant Camera Operator">"A" 2nd Assistant Camera Operator</option>
                <option value="B Camera Operator">"B" Camera Operator</option>
                <option value="B 1st Assistant Camera Operator">"B" 1st Assistant Camera Operator</option>
                <option value="B 2nd Assistant Camera Operator">"B" 2nd Assistant Camera Operator</option>
                <option value="Gaffer">Gaffer</option>
                <option value="Best Boy Electric">Best Boy Electric</option>
                <option value="Key Grip">Key Grip</option>
                <option value="Best Boy Grip">Best Boy Grip</option>
                <option value="Grip">Grip</option>
                <option value="Swing">Swing</option>
                <option value="Sound Mixer">Sound Mixer</option>
                <option value="Sound Operator">Sound Operator</option>
                <option value="Boom Operator">Boom Operator</option>
                <option value="Playback Operator">Playback Operator</option>
                <option value="Photographer">Photographer</option>
                <option value="Script Supervisor">Script Supervisor</option>
                <option value="Production Assistant">Production Assistant</option>
                <option value="Production Coordinator">Production Coordinator</option>
                <option value="Digital Imaging Technician">Digital Imaging Technician</option>
                <option value="Make Up Artist">Make Up Artist</option>
                <option value="Assistant Make Up Artist">Assistant Make Up Artist</option>
                <option value="Set Designer">Set Designer</option>
                <option value="Set Production Assistant">Set Production Assistant</option>
                <option value="Creative Director">Creative Director</option>
                <option value="Account Director">Account Director</option>
              </select>
              <p class="no-margin" ng-show="crew.offer.position"> {{crew.offer.position}} </p>
            </div>
            <div ng-if="productionCtrl.isProducer" class="col-xs-2">
              <!-- <div class="form-group"> -->
                <input ng-hide="crew.offer.rate" class="form-control bg-transparent subtle-border-2" ng-model="productionCtrl.offers[$index].rate" placeholder="Rate"></input>
                <p class="no-margin" ng-show="crew.offer.rate"> {{ crew.offer.rate | currency:"$":0}} </p>
              <!-- </div> -->
            </div>
            <div class="{{ productionCtrl.isProducer ? 'col-xs-2' : 'col-xs-4' }}">
              <!-- <div class="form-group"> -->
                <input ng-hide="crew.offer.hours" class="form-control bg-transparent subtle-border-2" ng-model="productionCtrl.offers[$index].hours" placeholder="Hours"></input>
                <p class="no-margin" ng-show="crew.offer.hours"> {{ crew.offer.hours }} hour<span ng-if="crew.offer.hours != 1">s</span> </p>
              <!-- </div> -->
            </div>
            <div ng-if="productionCtrl.isProducer" class="col-xs-3 no-padding text-right top-margin5">
              <a ng-if="crew.offer.status === 'None'" ng-click="productionCtrl.makeOffer(crew._id, $index)"
               class="btn main-btn">Hire</a>
              <a ng-if="crew.offer.status === 'Pending'" class="btn approval-btn remove-btn-hover">Pending</a>
              <a ng-if="crew.offer.status ===
              'Accepted'" class="btn approval-alt-btn">Hired</a>
              <a ng-if="crew.offer.status === 'Pending' || crew.offer.status ===
              'Accepted'" href="/#/offer/{{crew._id}}" class="btn default-btn">View Offer</a>
              <a ng-if="productionCtrl.compareDate(productionCtrl.production.date)" ng-click="productionCtrl.removeFromCrew(crew._id, $index)"><i class="fa fa-times"></i></a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="modal-root" ng-show="productionCtrl.showModal">
  <div id="modal-container" ng-click="productionCtrl.closeModal($event)">
    <div id="modal" class="section">
      <div class="col-sm-12 padding20">
        <div class="col-sm-8 no-padding">
          <h3 class="title">APPROVED CREW</h3>
        </div>
        <div class="col-sm-4 no-padding">
          <p class="title"><input type="text" class="form-control bg-transparent subtle-border padding15" placeholder="Search" ng-model="crewFilter"></p>
        </div>
      </div>

      <div class="group">
        <div class="line-item" ng-if="productionCtrl.currentUser.contacts.length < 5">
          <div class="col-sm-10 col-sm-offset-1">
            <p class="strong no-margin">Add contacts so that you can begin hiring for productions!</p>
          </div>
        </div>
        <div class="line-item" ng-repeat="crew in productionCtrl.currentUser.contacts | filter: crewFilter track by $index">
          <div class="row">
            <div class="col-xs-1 text-left">
              <img class="thumb round" ng-src="{{crew.picture}}">
            </div>
            <div class="col-xs-3">
              <p class="no-margin">{{crew.first_name + ' ' + crew.last_name}}</p>
            </div>
            <div class="col-xs-2">
              <p class="no-margin">{{crew.title}}</p>
            </div>
            <div class="col-xs-3">
              <p class="no-margin">{{crew.location}}</p>
            </div>
            <div class="col-xs-3 text-right">
              <p class="no-margin"><a ng-href="/#/profile/{{crew._id}}" class="btn default-btn">View</a>
              <a ng-click="productionCtrl.addToCrew(crew._id)" class="btn main-btn">Add</a></p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="modal-root" ng-if="productionCtrl.notifModal.show">
  <div id="modal-container" ng-click="productionCtrl.closeNotifModal()">
    <div id="modal-sm" class="section">
      <div class="padding20 text-center">
        <h1><i ng-if="productionCtrl.notifModal.isSuccess" class="fa fa-check-circle-o"></i></h1>
        <h1><i ng-if="productionCtrl.notifModal.isFailure" class="fa fa-times-circle-o"></i></h1>
        <p>{{ productionCtrl.notifModal.content }}</p>
        <p><a class="btn approval-btn">Close</a></p>
      </div>
    </div>
  </div>
</div>
